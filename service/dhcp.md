<!--
 * @Author: jangrui
 * @Date: 2019-08-19 14:52:07
 * @LastEditors: jangrui
 * @LastEditTime: 2019-08-19 16:39:08
 * @Description:  
 -->
 
# DHCP

DHCP: (Dynamic Host Configuration Protocol) 动态分配IP

## 主要用途

- 用于内部网络和网络服务供应商自动分配IP地址给用户
- 用于内部网络管理员作为对所有电脑作集中管理的手段
- 使用场景
- 自动化安装系统
- 解决IPV4资源不足问题

## 名词

- `dhcp客户端`：需要获取ip等信息
- `dhcp服务端`：提供ip等信息
- `作用域`：一个完整的IP地址段，DHCP协议根据作用域来管理网络的分布、分配IP地址及其他配置参数。
- `超级作用域`：用于管理处于同一个物理网络中的多个逻辑子网段。超级作用域中包含了可以统一管理的作用域列表。
- `排除范围`：把作用域中的某些IP地址排除，确保这些IP地址不会分配给DHCP客户端。
- `保留地址`：（地址绑定）将ip和mac地址绑定
- `共享作用域`：（dhcp超级作用域）一堆作用域的集合
- `地址池`：在定义了DHCP的作用域并应用了排除范围后，剩余的用来动态分配给DHCP客户端的IP地址范围。
- `租约`：DHCP客户端能够使用动态分配的IP地址的时间。租约时间到期后自动回收主机的IP地址，以免造成IP地址的浪费。
- `预约`：保证网络中的特定设备总是获取到相同的IP地址。
- `中继代理`：用于在不同网段中，转发DHCP请求信息的设备

## 租约更新

- `过去50%时`：客户端主动联系服务端，如果收到回应，会使用服务端重新分配的ip（可能是之前的，可能为新），如果没有收到回应，继续使用
- `过去75%时`：客户端主动联系服务端，如果收到回应，会使用服务端重新分配的ip（可能是之前的，可能为新），如果没有收到回应，继续使用
- `过去87.5%时`：客户端主动联系服务端，如果收到回应，会使用服务端重新分配的ip（可能是之前的，可能为新），如果没有收到回应，客户端会重新开始租约过程，使用网内其它dhcp服务端提供的ip。如果网内没有dhcp服务端回应，客户端仍可使用之前的地址，直到租约到期
  
    > `注意`：客户端重启时会自动释放掉获取的 IP，重启后会主动联系 dhcp 服务端，如果租约没有到期，且得到服务端回应，客户机会继续使用之前的 IP，否则会每五分钟尝试一次 IP 租用。
    
> `租用失败`：windows 会自动设置成169.254.*.* 

## 安装 dhcp 服务

```bash
yum install -y dhcp
systemctl start dhcpd
```

## 配置文件

